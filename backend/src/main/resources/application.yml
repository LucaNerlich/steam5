name: default
spring:
  application:
    name: steam5
  profiles:
    active: ${SPRING_PROFILE:dev} # Default to 'dev', allow override via env (e.g., coolify in Docker)
  datasource:
    url: ${JDBC_URL:jdbc:postgresql://localhost:5432/steam5_db}
    username: steam5_user
    password: steam5_password
    driver-class-name: org.postgresql.Driver
    name: steam5_db
  jackson:
    serialization:
      indent-output: true
      order-map-entries-by-keys: true
  sql:
    init:
      mode: always
      platform: postgres
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    defer-datasource-initialization: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
  quartz:
    properties:
      org.quartz.scheduler.idleWaitTime: 1000 # 1000 is minimum
      org.quartz.threadPool.threadCount: 5
      jdbc.batch_size: 50
      order_inserts: true
      order_updates: true
      order_deletes: true
  web:
    error:
      include-message: always
server:
  port: ${SERVER_PORT:8080}
  forward-headers-strategy: framework
  compression:
    enabled: true
    mime-types: application/json, text/html, text/plain
    min-response-size: 1KB
logging:
  level:
    root: INFO
    org.springframework: INFO
    org.hibernate: WARN
auth:
  redirectBase: ${REDIRECT_BASE:http://localhost:3000}
review:
  game:
    # days to avoid reusing an appid after it was picked; increase for fewer repeats
    do-not-repeat-days: 3650
    # dynamic bucket boundaries for guessing game (inclusive upper bounds in ascending order)
    bucket-boundaries: [ 13, 111, 855, 6467 ]
    bucketTitles: [ 'unknown', 'niche', 'rising', 'popular', 'star' ]
    low-percentile: ${LOW_PERCENTILE:0.65}
    high-percentile: ${HIGH_PERCENTILE:0.95}
    # refresh reviews for picked apps when older than N days
    min-reviews-fresh-days: ${MIN_REVIEWS_FRESH_DAYS:7}

season:
  # default season length in days; persisted seasons keep their own dates if this changes mid-season
  length-days: ${SEASON_LENGTH_DAYS:30}
  awards:
    # how many placement levels to award per category (e.g., 1=winner only, 3=top three)
    max-placements: ${SEASON_AWARDS_MAX_PLACEMENTS:1}
    # categories evaluated per season; names must match SeasonAwardCategory enum
    categories:
      - MOST_POINTS
      - MOST_HITS

# per-job enable/disable toggles
jobs:
  steam-app-list:
    enabled: ${JOB_INGEST_LIST:false}
  steam-app-reviews:
    enabled: ${JOB_INGEST_REVIEWS:false}
  steam-app-details:
    enabled: ${JOB_INGEST_DETAILS:false}
  review-game-state:
    enabled: ${JOB_GENERATE_REVIEW_STATE:false}
  blurhash:
    enabled: ${JOB_BLURHASH:false}
  blurhashAvatar:
    enabled: ${JOB_BLURHASH_AVATAR:false}
  reviews-refresh:
    enabled: ${JOB_REVIEWS_REFRESH:false}
    nightly-limit: ${JOB_REVIEWS_REFRESH_LIMIT:15000}
  seasons-finalizer:
    enabled: ${JOB_SEASONS_FINALIZER:true}

